# status

boots, uses uart as console, rtc, runs dis programs, basic network support (dhcp & mount working).

next steps:
- find problems/crashes
- more ethernet (link changes, more proper init, more efficient packet handling)
- storage (sdio? nand?)
- l1/l2 caches?
- improve uart (mode setting)
- crypto support
- later: usb,twsi,spi,gpio,sata,audio(i2s),efuse,pciexpress,xor


# intro

this is to be a port of inferno to the kirkwood soc, and the
sheevaplug in particular/at first.

this is work in progress.


# instructions

make sure the contents of this directory are available in
$ROOT/os/kirkwood/.
make sure $ROOT/os/init/sheevainit.b is the same as
$ROOT/os/kirkwood/sheevainit.b (by copy, symlink or bind).
make sure $ROOT/dis/initsheeva is the same as
$ROOT/os/kirkwood/misc/initsheeva.

to compile a kernel, "mk install".  this will create "uisheeva" and
"uisheeva.gz" (the same kernels, but one is compressed).  these are
in the "uimage" format, as expected by the sheeva's u-boot.

for compiling a kernel, the program "mkuimage" is needed.  build &
install it it by "cd mkuimage && mk install".


# booting

we can only boot from tftp for now.  set up a dhcp & tftp server.
the dhcp server should have a boot file name (the kernel, e.g.
uisheeva.gz) and a next server (the ip address of the tftp server)
configured.

after reset, hit some keys to prevent u-boot from auto-booting.
the following commands boot inferno:

	dhcp    # configure ethernet
	tftp    # fetch kernel
	bootm   # boot the kernel

inferno boots into a shell.  a few commands are available.  for
development, mdb is useful for reading/writing registers, e.g.:

	mdb -w /dev/sheevaregs

to make mdb do anything useful with the sheevaplugs registers (which
are configured at 0xf1000000, high bit set), you'll need to apply
the patch misc/mdb.b.diff.

to configure network with dhcp, and provide shells on the telnet port:

	run /dis/initsheeva


# licence

the kernel code is released under the same licence as the inferno-os
code.

mkuimage is public domain, written by mechiel lukkien, reachable
at mechiel@ueber.net or mechiel@xs4all.nl.
