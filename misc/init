#!/dis/sh.dis
load std
autoload=(std)

bind -a '#o' /dev	# sdio
bind -a '#Ï†' /dev	# efuse
bind -a '#T' /dev	# sheeva
bind -a '#B' /dev	# boot

mount {mntgen} /n
memfs /tmp

echo static | run /netrc

echo watchdog off > /dev/sheevactl
echo debug off > /dev/sdioctl
echo init > /dev/sdioctl
cat /dev/sdioctl

echo dossrv
dossrv  -f /dev/sdio -m /n/dos

bind -b /n/dos/dis /dis
bind -b /n/dos/keydb /keydb
bind -b /n/dos/nvfs /nvfs
bind -b /n/dos/usr /usr
bind -b /n/dos/man /man

# TODO get nvkey from efuse
echo svc
run /dis/svc/auth
run /dis/svc/styx
run /dis/svc/rstyx

while {} {
	echo shell...
	sh -i
	echo
}
